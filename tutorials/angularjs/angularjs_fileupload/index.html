<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<style>
@import url(https://fonts.googleapis.com/earlyaccess/nanumgothic.css); /* 나눔고딕 : 'Nanum Gothic' */
</style>
<title>WebFrameworks.kr - AngularJS 파일 업로드 지시자를 이용하여 비동기 파일 업로드 처리하기</title>
<link rel="stylesheet" href="/static/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/css/main.css">
<link rel="stylesheet" href="/static/css/syntax.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/static/css/toc.css">
    <script type="text/javascript" src="/static/js/jquery.toc.js"></script>
</head>
<body>
<nav class="navbar navbar-default top_menu" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">웹Frameworks</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-1">
            <ul class="nav navbar-nav navbar-left">
                <li><a href="/getstarted">Get Started</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="/updates">Update</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="/tutorials">Tutorials</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="/quickstart">Quick Start</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="/archives">Archives</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="https://github.com/KoreaHTML5/webframeworks.kr/blob/master/CONTRIBUTE.md" target="_blank">참여하기</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-left">
                <li><a href="http://goo.gl/forms/MB9ZxVvdrD" target="_blank">설문하기</a></li>
            </ul>
        </div>
    </div>
</nav>


<div class="content_bg"  style="background-color: #DD1B16;color: #FFFFFF;" >
<div class="col-md-10 col-md-offset-1 title_header jumbotron"  style="background:url() no-repeat center"  >
<h1 class="title_header_title">AngularJS 파일 업로드 지시자를 이용하여 비동기 파일 업로드 처리하기</h1>
<p class="title_header_summary">서버에 파일을 업로드할때 사용하는 별도 업로드 지시자를 소개하고 간단한 사용법을 익혀봅니다.</p>
</div>
</div>

<div>

    <div class="col-sm-3 col-md-2 col-md-offset-2">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">작성자</h3>
            </div>
            <div class="panel-body">
                <div class="media">
                    <a class="pull-left" href="#">
                        <img class="media-object profile_img" src="https://avatars0.githubusercontent.com/u/912457?v=2&u=d21f5c15ee6f71c888c43b7bf42b147a7a68ce08&s=140" alt="고재도">
                    </a>
                    <div class="media-body">
                        <h4 class="media-heading">
                            고재도

                        </h4>
                        jeado<br>
                    </div>
                </div>
            </div>
        </div>

        <div id="toc_location"></div>

        <div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>
    <div class="panel-body">
        <a href='/tags/jquery/' style='color: rgba(0,0,0,0.054873)'>jquery</a>
<a href='/tags/javascript/' style='color: rgba(0,0,0,9.383208)'>javascript</a>
<a href='/tags/html/' style='color: rgba(0,0,0,0.054873)'>html</a>
<a href='/tags/grunt/' style='color: rgba(0,0,0,0.054873)'>grunt</a>
<a href='/tags/gulp/' style='color: rgba(0,0,0,0.054873)'>gulp</a>
<a href='/tags/build/' style='color: rgba(0,0,0,0.329235)'>build</a>
<a href='/tags/yeoman/' style='color: rgba(0,0,0,0.054873)'>yeoman</a>
<a href='/tags/foundation/' style='color: rgba(0,0,0,0.054873)'>foundation</a>
<a href='/tags/bower/' style='color: rgba(0,0,0,0.109745)'>bower</a>
<a href='/tags/twitter/' style='color: rgba(0,0,0,0.109745)'>twitter</a>
<a href='/tags/framework/' style='color: rgba(0,0,0,2.140030)'>framework</a>
<a href='/tags/angularjs/' style='color: rgba(0,0,0,0.932834)'>angularjs</a>
<a href='/tags/tutorials/' style='color: rgba(0,0,0,1.207196)'>tutorials</a>
<a href='/tags/backbone/' style='color: rgba(0,0,0,0.219490)'>backbone</a>
<a href='/tags/getstarted/' style='color: rgba(0,0,0,0.164618)'>getstarted</a>
<a href='/tags/underscore/' style='color: rgba(0,0,0,0.054873)'>underscore</a>
<a href='/tags/library/' style='color: rgba(0,0,0,0.384108)'>library</a>
<a href='/tags/Ext/' style='color: rgba(0,0,0,0.493853)'>Ext</a>
<a href='/tags/JS/' style='color: rgba(0,0,0,0.768216)'>JS</a>
<a href='/tags/tutorial/' style='color: rgba(0,0,0,0.713343)'>tutorial</a>
<a href='/tags/modernizr/' style='color: rgba(0,0,0,0.054873)'>modernizr</a>
<a href='/tags/bootstrap/' style='color: rgba(0,0,0,0.164618)'>bootstrap</a>
<a href='/tags/quickstart/' style='color: rgba(0,0,0,0.054873)'>quickstart</a>
<a href='/tags/angular-di/' style='color: rgba(0,0,0,0.054873)'>angular-di</a>
<a href='/tags/animation/' style='color: rgba(0,0,0,0.219490)'>animation</a>
<a href='/tags/router/' style='color: rgba(0,0,0,0.054873)'>router</a>
<a href='/tags/promise/' style='color: rgba(0,0,0,0.274363)'>promise</a>
<a href='/tags/responsive/' style='color: rgba(0,0,0,0.054873)'>responsive</a>
<a href='/tags/form/' style='color: rgba(0,0,0,0.109745)'>form</a>
<a href='/tags/validation/' style='color: rgba(0,0,0,0.109745)'>validation</a>
<a href='/tags/map/' style='color: rgba(0,0,0,0.054873)'>map</a>
<a href='/tags/direcitve/' style='color: rgba(0,0,0,0.054873)'>direcitve</a>
<a href='/tags/file/' style='color: rgba(0,0,0,0.109745)'>file</a>
<a href='/tags/test/' style='color: rgba(0,0,0,0.219490)'>test</a>
<a href='/tags/ui-bootstrap/' style='color: rgba(0,0,0,0.054873)'>ui-bootstrap</a>
<a href='/tags/twitter-bootstrap/' style='color: rgba(0,0,0,0.054873)'>twitter-bootstrap</a>
<a href='/tags/express/' style='color: rgba(0,0,0,0.109745)'>express</a>
<a href='/tags/express.js/' style='color: rgba(0,0,0,0.054873)'>express.js</a>
<a href='/tags/node.js/' style='color: rgba(0,0,0,0.219490)'>node.js</a>
<a href='/tags/backend/' style='color: rgba(0,0,0,0.164618)'>backend</a>
<a href='/tags/d3.js/' style='color: rgba(0,0,0,0.054873)'>d3.js</a>
<a href='/tags/visualization/' style='color: rgba(0,0,0,0.329235)'>visualization</a>
<a href='/tags/reactjs/' style='color: rgba(0,0,0,0.109745)'>reactjs</a>
<a href='/tags/expressjs/' style='color: rgba(0,0,0,0.384108)'>expressjs</a>
<a href='/tags/react/' style='color: rgba(0,0,0,1.316942)'>react</a>
<a href='/tags/session/' style='color: rgba(0,0,0,0.109745)'>session</a>
<a href='/tags/meteor/' style='color: rgba(0,0,0,0.768216)'>meteor</a>
<a href='/tags/SEO/' style='color: rgba(0,0,0,0.054873)'>SEO</a>
<a href='/tags/REST/' style='color: rgba(0,0,0,0.054873)'>REST</a>
<a href='/tags/API/' style='color: rgba(0,0,0,0.054873)'>API</a>
<a href='/tags/es2015/' style='color: rgba(0,0,0,0.109745)'>es2015</a>
<a href='/tags/es6/' style='color: rgba(0,0,0,0.603598)'>es6</a>
<a href='/tags/es7/' style='color: rgba(0,0,0,0.109745)'>es7</a>
<a href='/tags/DDP/' style='color: rgba(0,0,0,0.054873)'>DDP</a>
<a href='/tags/ngMessages/' style='color: rgba(0,0,0,0.109745)'>ngMessages</a>
<a href='/tags/jsx/' style='color: rgba(0,0,0,0.054873)'>jsx</a>
<a href='/tags/publish/' style='color: rgba(0,0,0,0.054873)'>publish</a>
<a href='/tags/subscribe/' style='color: rgba(0,0,0,0.054873)'>subscribe</a>
<a href='/tags/meteor.js/' style='color: rgba(0,0,0,0.054873)'>meteor.js</a>
<a href='/tags/reactive/' style='color: rgba(0,0,0,0.054873)'>reactive</a>
<a href='/tags/package/' style='color: rgba(0,0,0,0.054873)'>package</a>
<a href='/tags/static/' style='color: rgba(0,0,0,0.054873)'>static</a>
<a href='/tags/assets/' style='color: rgba(0,0,0,0.054873)'>assets</a>
<a href='/tags/public/' style='color: rgba(0,0,0,0.054873)'>public</a>
<a href='/tags/flux/' style='color: rgba(0,0,0,0.219490)'>flux</a>
<a href='/tags/redux/' style='color: rgba(0,0,0,0.384108)'>redux</a>
<a href='/tags/server/' style='color: rgba(0,0,0,0.054873)'>server</a>
<a href='/tags/distribution/' style='color: rgba(0,0,0,0.054873)'>distribution</a>
<a href='/tags/webpack/' style='color: rgba(0,0,0,0.164618)'>webpack</a>
<a href='/tags/development/' style='color: rgba(0,0,0,0.054873)'>development</a>
<a href='/tags/optimization/' style='color: rgba(0,0,0,0.054873)'>optimization</a>
<a href='/tags/immutable/' style='color: rgba(0,0,0,0.054873)'>immutable</a>
<a href='/tags/orm/' style='color: rgba(0,0,0,0.219490)'>orm</a>
<a href='/tags/database/' style='color: rgba(0,0,0,0.219490)'>database</a>
<a href='/tags/hapi.js/' style='color: rgba(0,0,0,0.054873)'>hapi.js</a>
<a href='/tags/hapi/' style='color: rgba(0,0,0,0.219490)'>hapi</a>
<a href='/tags/ionic/' style='color: rgba(0,0,0,0.109745)'>ionic</a>
<a href='/tags/hybrid-app/' style='color: rgba(0,0,0,0.054873)'>hybrid-app</a>
<a href='/tags/django/' style='color: rgba(0,0,0,0.054873)'>django</a>
<a href='/tags/fullstack/' style='color: rgba(0,0,0,0.054873)'>fullstack</a>
<a href='/tags/spa/' style='color: rgba(0,0,0,0.054873)'>spa</a>
<a href='/tags/ExpressJS/' style='color: rgba(0,0,0,0.274363)'>ExpressJS</a>
<a href='/tags/NodeJS/' style='color: rgba(0,0,0,0.274363)'>NodeJS</a>
<a href='/tags/Sequelize/' style='color: rgba(0,0,0,0.274363)'>Sequelize</a>
<a href='/tags/Mocha/' style='color: rgba(0,0,0,0.274363)'>Mocha</a>
<a href='/tags/Supertest/' style='color: rgba(0,0,0,0.274363)'>Supertest</a>
<a href='/tags/UnitTest/' style='color: rgba(0,0,0,0.274363)'>UnitTest</a>
<a href='/tags/this/' style='color: rgba(0,0,0,0.109745)'>this</a>
<a href='/tags/dom/' style='color: rgba(0,0,0,0.054873)'>dom</a>
<a href='/tags/es5/' style='color: rgba(0,0,0,0.109745)'>es5</a>
<a href='/tags/virtualdom/' style='color: rgba(0,0,0,0.109745)'>virtualdom</a>
<a href='/tags/modules/' style='color: rgba(0,0,0,0.054873)'>modules</a>
<a href='/tags/asynchronous/' style='color: rgba(0,0,0,0.054873)'>asynchronous</a>
<a href='/tags/semicolon/' style='color: rgba(0,0,0,0.054873)'>semicolon</a>
<a href='/tags/nodejs/' style='color: rgba(0,0,0,0.109745)'>nodejs</a>
<a href='/tags/ECMAScript2015/' style='color: rgba(0,0,0,0.109745)'>ECMAScript2015</a>
<a href='/tags/babel/' style='color: rgba(0,0,0,0.054873)'>babel</a>
<a href='/tags/angular,/' style='color: rgba(0,0,0,0.054873)'>angular,</a>
<a href='/tags/electron/' style='color: rgba(0,0,0,0.109745)'>electron</a>
<a href='/tags/docker/' style='color: rgba(0,0,0,0.274363)'>docker</a>
<a href='/tags/D3/' style='color: rgba(0,0,0,0.054873)'>D3</a>
<a href='/tags/node/' style='color: rgba(0,0,0,0.109745)'>node</a>
<a href='/tags/aws/' style='color: rgba(0,0,0,1.371814)'>aws</a>
<a href='/tags/dynamoDB/' style='color: rgba(0,0,0,0.054873)'>dynamoDB</a>
<a href='/tags/chrome/' style='color: rgba(0,0,0,0.054873)'>chrome</a>
<a href='/tags/native/' style='color: rgba(0,0,0,0.109745)'>native</a>
<a href='/tags/markdown/' style='color: rgba(0,0,0,0.054873)'>markdown</a>
<a href='/tags/vue/' style='color: rgba(0,0,0,2.030285)'>vue</a>
<a href='/tags/middleware/' style='color: rgba(0,0,0,0.054873)'>middleware</a>
<a href='/tags/IoT/' style='color: rgba(0,0,0,0.054873)'>IoT</a>
<a href='/tags/serverless/' style='color: rgba(0,0,0,0.493853)'>serverless</a>
<a href='/tags/python/' style='color: rgba(0,0,0,0.164618)'>python</a>
<a href='/tags/socket.io/' style='color: rgba(0,0,0,0.164618)'>socket.io</a>
<a href='/tags/typescript/' style='color: rgba(0,0,0,0.054873)'>typescript</a>
<a href='/tags/laravel/' style='color: rgba(0,0,0,1.371814)'>laravel</a>
<a href='/tags/github/' style='color: rgba(0,0,0,0.109745)'>github</a>
<a href='/tags/slack/' style='color: rgba(0,0,0,0.109745)'>slack</a>
<a href='/tags/data/' style='color: rgba(0,0,0,0.274363)'>data</a>
<a href='/tags/opensource/' style='color: rgba(0,0,0,0.054873)'>opensource</a>
<a href='/tags/pwa/' style='color: rgba(0,0,0,0.054873)'>pwa</a>
<a href='/tags/vuejs/' style='color: rgba(0,0,0,0.384108)'>vuejs</a>
<a href='/tags/nextjs/' style='color: rgba(0,0,0,0.109745)'>nextjs</a>

    </div>
</div>
    </div>

    <div class="col-sm-9 col-md-6">
        <div class="media_content media_item shadow_panel" id="main_content">
            <h1>AngularJS 파일 업로드 지시자를 이용하여 비동기 파일 업로드 처리하기</h1>

<p>웹 어플리케이션을 개발하다보면 브라우저에서 파일을 전송하여 서버에 저장해야할 케이스가 종종있다. 대체로 동기방식은 멀티파일 업로드처리를 하는데 이 경우 화면이 리플레쉬되고 특정 페이지로 이동을 한다. 그래서 단일페이지 웹 어플리케이션에서는 비동기 파일 업로드가 필요하다. 하지만 AngularJS 만으론 이러한 요구사항을 처리하기엔 부족함이 많다. 우리는 이번 튜토리얼에서 <a href="https://github.com/danialfarid">Danial Farid</a>가 만들어서 오픈소스(MIT License)로 공개한 <a href="https://github.com/danialfarid/angular-file-upload">angular-file-upload</a>를 이용하여 비동기 파일업로드 처리를 알아보겠다.</p>

<h2>angular-file-upload 설치하기</h2>

<p>angular-file-upload를 다운로드는 다음 주소에서 받거나 bower를 이용할 수 있다.</p>

<ol>
<li><a href="https://github.com/danialfarid/angular-file-upload-bower/releases">danialfarid/angular-file-upload-bower 릴리즈 브렌치</a>에서 다운로드</li>
<li><code>bower install ng-file-upload --save</code></li>
</ol>

<p>다운로드를 완료하였다면 다음과 같이 스크립트 태그를 적용할 HTML 파일을 추가한다.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- 최신 브라우저는 progress 이벤트를 사용하기위해서 필요하고 구 브라우저(IE8과 같은)는 HTML5 업로드 기능을 위해서 필요하다. --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;angular-file-upload-shim.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span> 
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;angular-file-upload.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<h3>IE8, IE9 지원</h3>

<p>angular-file-upload 모듈은 progress 이벤트를 처리하거나 HTML5 지원을 위한 angular-file-upload-shim.min.js을 별도로 제공한다. 파일이 업로드되는 progress처리를 하지 않는다변 shim 파일이 필요가 없고 IE8과 IE9은 shim과 함께 <a href="https://github.com/mailru/FileAPI">FileAPI</a>가 필요하다.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script&gt;</span>
    <span class="c1">//IE8과 IE9을 지원하기 위해서는 angular-file-upload-shim(.min).js 전에 작성이 필요하다.</span>
    <span class="nx">FileAPI</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">//jsPath 또는 jsUrl 둘 중 원하는거 하나만 사용.</span>
        <span class="nx">jsPath</span><span class="o">:</span> <span class="s1">&#39;/js/FileAPI.min.js/folder/&#39;</span><span class="p">,</span> 
        <span class="nx">jsUrl</span><span class="o">:</span> <span class="s1">&#39;yourcdn.com/js/FileAPI.min.js&#39;</span><span class="p">,</span>

        <span class="c1">//staticPath 또는 flashUrl 둘 중 원하는거 하나만 사용.</span>
        <span class="nx">staticPath</span><span class="o">:</span> <span class="s1">&#39;/flash/FileAPI.flash.swf/folder/&#39;</span><span class="p">,</span>
        <span class="nx">flashUrl</span><span class="o">:</span> <span class="s1">&#39;yourcdn.com/js/FileAPI.flash.swf&#39;</span><span class="p">,</span>

        <span class="c1">//forceLoad: true, html5: false //HTML5 브라우저에서 디버그 하려면 설정</span>
    <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;angular-file-upload-shim.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>...</code></pre></div>

<p>그럼 간단한 파일 업로드 클라이언트를 만들어보자. 다음과 같이 upload-client.html 파일을 만든다.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">&quot;demoApp&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="c">&lt;!-- 생략 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;libs/ng-file-upload/angular-file-upload-shim.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;libs/angular/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;libs/ng-file-upload/angular-file-upload.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span> 
    <span class="nt">&lt;script&gt;</span>
      <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;demoApp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;angularFileUpload&#39;</span><span class="p">])</span>
      <span class="c1">//angularFileUpload 모듈을 사용하면 $upload 서비스를 주입받아 사용할 수 있다.</span>
      <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;mainCtrl&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span><span class="s1">&#39;$upload&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$upload</span><span class="p">)</span> <span class="p">{</span>

      <span class="p">}]);</span>   
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span> <span class="na">ng-controller=</span><span class="s">&quot;mainCtrl&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-xs-12 col-sm-12 col-md-12 col-lg-12&quot;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<h2>파일업로드 서버 구성</h2>

<p>파일 업로드를 하려면 업로드 서버가 있어야 한다. Java든 PHP든 어떠한 서버든 상관없지다. 본 튜토리얼에서는 node.js와 express.js로 파일 서버를 만들었다. </p>

<p>파일 업로드 서버는 /upload와 /uploadWithData에 업로드 요청을 하면된다. 자세현 구현 코드는 <a href="https://github.com/jeado/web-angular-sample/tree/fileupload">GitHub web-angular-sample 프로젝트의 fileupload Branch</a>에서 upload-server.js를 참고하기 바란다.</p>

<h2>파일선택시 즉각 비동기 업로드</h2>

<p>그럼 이제 실제 파일 업로드 처리를 해보자. upload-client.html에 다음과 같이 코드를 수정하자.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- 생략 --&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;demoApp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;angularFileUpload&#39;</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;mainCtrl&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span><span class="s1">&#39;$upload&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$upload</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//파일이 선택되면 호출된다. 이때 $files인자를 통해 파일 데이터를 배열로 받아온다.</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">onFileSelect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$files</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">$files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">$files</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="c1">//$upload 서비스를 통해 실제 비동기 업로드를 수행한다. 이떄 HTTP 경로와 메소드 그리고 해당 파일 필드이름을 지정할 수 있다.</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">upload</span> <span class="o">=</span> <span class="nx">$upload</span><span class="p">.</span><span class="nx">upload</span><span class="p">({</span>
              <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/upload&#39;</span><span class="p">,</span>   <span class="c1">//경로</span>
              <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>   <span class="c1">//메소드</span>
              <span class="nx">file</span><span class="o">:</span><span class="nx">file</span><span class="p">,</span>        <span class="c1">//파일</span>
              <span class="nx">fileFormDataName</span> <span class="o">:</span> <span class="s1">&#39;fileField1&#39;</span><span class="p">,</span>  <span class="c1">//필드이름</span>
            <span class="p">}).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">headers</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
              <span class="c1">//upload를 하고 성공시 콜백처리를 success 메소드를 통해 할 수 있다.</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">});</span>
          <span class="p">}</span>
        <span class="p">};</span>
      <span class="p">}]);</span>   
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span> <span class="na">ng-controller=</span><span class="s">&quot;mainCtrl&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-xs-12 col-sm-12 col-md-12 col-lg-12&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;h3&gt;</span>선택시 파일 업로드<span class="nt">&lt;/h3&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;example&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;form</span> <span class="na">role=</span><span class="s">&quot;form&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form-group&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;label&gt;</span>파일<span class="nt">&lt;/label&gt;</span>
                <span class="c">&lt;!-- file 타입에 ng-file-select 지시자를 사용하면 파일이 선택될 때 마다 호출할 표현식을 값으로 줄 수 있다. 여기선 $scope의 onFileSelect 메소드를 호출한다.--&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">ng-file-select=</span><span class="s">&quot;onFileSelect($files)&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/form&gt;</span>            
          <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>이제 브라우저에서 upload-client.html를 열어보자. node.js로 서버를 구동하려면 커맨드 창에서 다음과 같이 명령어를 입력한다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">node upload-server.js #에러가 발생하면 npm install을 하도록 한다.
</code></pre></div>
<p>파일을 하나 업로드하면 아래 그림과 같이 브라우저 콘솔창에 성공 메시지를 출력할 것이다.</p>

<p><img src="imgs/fileupload_tutorial_01.png" style="width:500px;height:300px;" alt="데모 업로드 클라이언트 그림" title="데모 업로드 클라이언트 그림"></p>

<p>그리고 서버폴더에서 uploads 폴더에 가보면 다음과 같이 업로드한 파일이 있을 것이다.</p>

<p><img src="imgs/fileupload_tutorial_02.png" style="width:300px;height:70px;" alt="이름" title="이름"></p>

<h2>파일과 데이터를 동시에 비동기 전송</h2>

<p>이번에는 특정 입력박스의 입력값과 파일을 버튼 클릭 시 전송하도록 하겠다. 아래 코드와 같이 코드를 수정하자.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">&quot;demoApp&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- 생략 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;libs/ng-file-upload/angular-file-upload-shim.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;libs/angular/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;libs/ng-file-upload/angular-file-upload.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span> 
    <span class="nt">&lt;script&gt;</span>
      <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;demoApp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;angularFileUpload&#39;</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;mainCtrl&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span><span class="s1">&#39;$upload&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$upload</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//생략</span>

      <span class="c1">//파일을 선택하면 전송하기 전에 파일 데이터를 보관해두었다가 send 호출 시 upload 서비스를 이용하여 전송</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">onFileSelect2</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$files</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">selectedFile</span> <span class="o">=</span> <span class="nx">$files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="p">};</span>

      <span class="nx">$scope</span><span class="p">.</span><span class="nx">send</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">selectedFile</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">){</span>
          <span class="nx">$scope</span><span class="p">.</span><span class="nx">upload</span> <span class="o">=</span> <span class="nx">$upload</span><span class="p">.</span><span class="nx">upload</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/uploadWithData&#39;</span><span class="p">,</span>
            <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
            <span class="nx">file</span><span class="o">:</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">selectedFile</span><span class="p">,</span>
            <span class="c1">//data 속성으로 별도의 데이터를 보냄.</span>
            <span class="nx">data</span> <span class="o">:</span> <span class="p">{</span>
              <span class="nx">email</span> <span class="o">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">email</span>
            <span class="p">},</span>
            <span class="nx">fileFormDataName</span> <span class="o">:</span> <span class="s1">&#39;fileField1&#39;</span><span class="p">,</span>
          <span class="p">}).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">headers</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//서버에서 전송시 보낸 email을 그대로 응답 데이터로 전달함.</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">successMsg</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">email</span><span class="o">+</span><span class="s2">&quot;로 전송 완료&quot;</span><span class="p">;</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">};</span>
      <span class="p">}]);</span>   
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span> <span class="na">ng-controller=</span><span class="s">&quot;mainCtrl&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;row&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;col-xs-12 col-sm-12 col-md-12 col-lg-12&quot;</span><span class="nt">&gt;</span>
          <span class="c">&lt;!-- 생략 --&gt;</span>
          <span class="nt">&lt;h3&gt;</span>버튼 클릭 시 입력데이터와 파일 전송<span class="nt">&lt;/h3&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;example&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;form</span> <span class="na">role=</span><span class="s">&quot;form&quot;</span> <span class="na">name=</span><span class="s">&quot;uploadForm&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;form-group&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;label&gt;</span>파일<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">ng-file-select=</span><span class="s">&quot;onFileSelect2($files)&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;br&gt;</span>
                <span class="nt">&lt;label&gt;</span>이메일<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;email&quot;</span> <span class="na">class=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;이메일&quot;</span><span class="nt">&gt;</span>
              <span class="nt">&lt;/div&gt;</span>
              <span class="c">&lt;!-- 버튼 클릭시 send 메소드 호출 --&gt;</span>
              <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">class=</span><span class="s">&quot;btn btn-default&quot;</span> <span class="na">ng-click=</span><span class="s">&quot;send()&quot;</span> <span class="na">ng-disabled=</span><span class="s">&quot;selectedFile == undefined&quot;</span><span class="nt">&gt;</span>button<span class="nt">&lt;/button&gt;</span>
            <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;br&gt;</span> 
            <span class="c">&lt;!-- 전송 성공시 메시지 출력 --&gt;</span>          
            <span class="nt">&lt;div&gt;</span>
              {{ successMsg }}
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>다시 브라우저에서 파일을 선택하고 이메일을 입력해보자. 이번에는 파일이 바로 전송되지 않을 것이다. button을 클릭하면 파일이 전송되는 것을 다음 그림과 같이 확인할 수 있다.</p>

<p><img src="imgs/fileupload_tutorial_03.png" style="width:600px;height:350px;" alt="이름" title="이름"></p>

<h2>References</h2>

<ul>
<li><a href="https://docs.angularjs.org/">angularjs official document</a></li>
<li><a href="https://github.com/danialfarid/angular-file-upload">An AngularJS directive for file upload using HTML5 with FileAPI polyfill for unsupported browsers</a></li>
</ul>

        </div>

        <div class="media_content media_item shadow_panel">
            <p>Tags : <a href="/tags/javascript">javascript</a>&nbsp;<a href="/tags/framework">framework</a>&nbsp;<a href="/tags/angularjs">angularjs</a>&nbsp;<a href="/tags/tutorials">tutorials</a>&nbsp;<a href="/tags/file">file</a>&nbsp;</p>
        </div>


        <div class="media_content media_item shadow_panel">
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'html5krforkisa'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
        </div>

    </div>

    <script>
        $('#main_content').toc();
    </script>
</div>
<footer>
<table width="100%" height="80" class="footer">
    <tr>
        <td align="center" class="footer_content">
            WebFrameworks.kr @since 2015
        </td>
    </tr>
</table>
</footer>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56520981-1', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>